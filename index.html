<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Oh also arrow keys move the camera.</title>
    <link href="/stylesheets/screen.css" media="all" rel="stylesheet" type="text/css"/>
    <script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript"></script><script language="javascript" src="javascripts/jquery.hotkeys.js" type="text/javascript"></script><script language="javascript" src="javascripts/key_status.js" type="text/javascript"></script><script language="javascript" src="javascripts/util.js" type="text/javascript"></script><script language="javascript" src="javascripts/sprite.js" type="text/javascript"></script><script language="javascript" src="javascripts/sound.js" type="text/javascript"></script>
  </head>
  <body>
  	<audio id="myAudio">
    <source src="song.mp3" type="audio/mpeg" />
    Your browser does not support the audio element.
    </audio>
    <h1>Hit H for controls. </h1>

    <script type='text/javascript'>
      //<![CDATA[
        var CANVAS_WIDTH = 900;
        var CANVAS_HEIGHT = 640;
		var MAP_WIDTH = 120;
        var MAP_HEIGHT = 80;
        var FPS = 30;
		//var keychart = ["w","a","d","s","up","right","down","left","m","n","shift"];
		var darkgrasssprite = Sprite("darkgrass");
		var grasssprite = Sprite("grass");
		var watersprite = Sprite("water");
		var lavasprite=[];
  		lavasprite[0] = Sprite("lava");
		lavasprite[1] = Sprite("lava1");
		lavasprite[2] = Sprite("lava2");
		lavasprite[3] = Sprite("lava3");
		lavasprite[4] = Sprite("lava4");
		var rocksprite = Sprite("stone2");
		var stonebricksprite = Sprite("stonewall");
		var bricksprite = Sprite("brick");
		var dirtsprite = Sprite("dirt");
		var woodsprite = Sprite("wood");
		var crystalsprite = Sprite("crystalfloor");
		var mudsprite = Sprite("mud");
		var obsidiansprite = Sprite("obsidian");
		var mossysprite = Sprite("mossy");
		var stonesprite = Sprite("stone");
		
		var claysprite = Sprite("clay");
		var pedastalsprite = Sprite("pedastal");
		var wtfsprite = Sprite("wtf");
		var cobblesprite = Sprite("cobblestone");
		var plankssprite = Sprite("woodplanks");
		var edsprite = Sprite("cursor");
		var shroomsprite = Sprite("shroom");
		Mode = 1;
		var playerBullets = [];
		//var keyboard = [];
		//for (l=0;l<10;l++){keyboard.push(akey(keychart[l]));}
		var NUM_TILES=17;
		var canX=[];
		var canY=[];
        var canvasElement = $("<canvas width='" + CANVAS_WIDTH + 
          "' height='" + CANVAS_HEIGHT + "'></canvas");
        var canvas = canvasElement.get(0).getContext("2d");
        canvasElement.appendTo('body');
        //todo:  find some way to put this in map or tile?
        var tileani=0;
		var anicount=0;
		var anirate=10;
		var gotall=false;
		//canvas.globalAlpha = 0.85;//todo: something with this
	
			
		function akey(k) {  //k,wkey?
		    k = k || "space";
			this.key =k;
			this.aflag=false;
			this.check= function(){
				if (keydown[this.key]) { 
					this.aflag=true;
					return false;
				}
				if((!keydown[this.key]) && (this.aflag==true)){
					this.aflag=false;
					return true;
				}
		    };
			return this;
		}
		
		function aMouse() {
			this.mX= 0;
			this.mY= 0;
			this.lastY=0;
			this.lastX=0;
			this.tx= 0;
			this.ty= 0;
			this.mDelta=0;
			this.wasWheeled= false;
			this.mouseIsDown= false;
		
			
			mouseXY= function(e) {
				if (!e) var e = event;
				mX = e.pageX - canvasElement.get(0).offsetLeft;
				mY = e.pageY - canvasElement.get(0).offsetTop;
				//alert("mousemoved");
				canX=mX;
				canY=mY;
			
				//showPos();
			};
			
			this.startStroke= function(e) {
				if (!e) var e = event;
				mDelta=e.wheelDelta;
				wasWheeled=true;
				
			};
			
			this.touchXY= function(e) { //touchsreen
			if (!e) var e = event;
			e.preventDefault();
			mX = e.targetTouches[0].pageX - canvasElement.get(0).offsetLeft;
			mY = e.targetTouches[0].pageY - canvasElement.get(0).offsetTop;
			//showPos();
			};
			
			mouseUp= function(e) {
			if (!e) var e = event;
			mouseIsDown = 0;
			mouseXY(e);
			};

			touchUp= function() {
			mouseIsDown = 0;
			// no touch to track, so just show state
			//do something.
			};

			mouseDown= function(e) {
			if (!e) var e = event;

			mouseIsDown = 1;
			mouseXY(e);
			lastX=tx;
			lastY=ty;
			tx=Math.floor(this.mX/16);
			ty=Math.floor(this.mY/16);

			};

			this.touchDown= function() {
			mouseIsDown = 1;
			//do something();
			};
			return this;
        }
		
		var Mouse= aMouse();
		
		canvasElement.get(0).addEventListener("mousewheel",Mouse.startStroke,false);
		canvasElement.get(0).addEventListener("mousemove", Mouse.mouseXY, false);
		canvasElement.get(0).addEventListener("mousedown", Mouse.mouseDown, false);

		canvasElement.get(0).addEventListener("touchstart", Mouse.touchDown, false);
		canvasElement.get(0).addEventListener("touchmove", Mouse.touchXY, true);   //TODO: Implement touch screen functions
        canvasElement.get(0).addEventListener("touchend", Mouse.touchUp, false);
 
		document.body.addEventListener("mouseup", Mouse.mouseUp, false);
		//document.body.addEventListener("touchcancel", Mouse.touchUp, false);
		
		var savekey=new akey("o");
		var loadkey=new akey("l");
		var upkey=new akey("w");
		var leftkey=new akey("a");
		var downkey=new akey("s");
		var rightkey=new akey("d");
	    var wkey=new akey("up");
		var dkey=new akey("right");
		var skey=new akey("down");
		var aakey=new akey("left");
		var modekey=new akey("m");
		var nkey=new akey("n");
		var shiftkey=new akey("shift");
		var helpkey=new akey("h");
		var slowkey=new akey("b");
		var cmousekey=new akey("v");
	    var defkey=new akey("j");
		
		var stuff=[];
		
		var camera = {
		    x: 0,
			y: 0,
			width: 60,
			height: 40,
			center: function(targ) {
			    tx=targ.x-26;
				ty=targ.y-20;
				if (tx<0) {tx=0;}
				if (ty<0) {ty=0;}
				if (tx>MAP_WIDTH-60) {tx=MAP_WIDTH-60;}
				if (ty>MAP_HEIGHT-40) {ty=MAP_HEIGHT-40;}

				this.x=tx;
				this.y=ty;
			},
			check: function() {
			    this.x.clamp(0, MAP_WIDTH-60);
				this.y.clamp(0, MAP_HEIGHT-40);
			},
			rX: function(fx)
			{
				return fx-this.x;
			},
			rY: function(fy)
			{
				return fy-this.y;
			}
		};
			
		function thing(px,py) {
		    
			this.x= px;
			this.y= py;
			this.active= true;
			this.width= 32;
			this.height= 32;
            this.sprite= Sprite("shroom");
			this.collectable= true;
			this.setSprite= function(name) {
				this.sprite= Sprite(name);
			};
			this.draw= function(cam) {
				this.sprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
			};
			this.colision= function(that) {
			    if( ((this.x==that.x) ||(this.x==that.x+1))&& ((this.y==that.y) || (this.y==that.y+1)) ) {
				     this.active=false;
					 return true;
				}
				return false;
			};
			this.update=function(ply) {
				if(this.colision(ply)) {this.active=false;}
			};
            return this;
		}
		

	    
        var bColors = ["#008000","#006400", "#FF4500", "#000080", "#696969", "#800080", "#808000", "#A52A2A", "#8B4513", "#FFDEAD", "#FFFF40","#000080" , "#FFFF80"];
		function makeNewTile() { 
		    var tile = {
                width: 16,
				height: 16,
				x: 0,
				y: 0,
				ani:0,
				color: "#FFC020",
				data: 0,
				draw: function(cam) { 
				    if(this.data==0){
					   grasssprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==1){
					   darkgrasssprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==2){
					   lavasprite[tileani].draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==3){
					   watersprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==4){
					   stonesprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==5){
					   obsidiansprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==6){
					   mudsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==7){
					   bricksprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==8){
					   woodsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==9){
					   crystalsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16); //todo: duplicate! add new type
					}else if(this.data==10){
					   mossysprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==11){
					   stonebricksprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==12){
					   plankssprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==13){
					   cobblesprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16); //todo: duplicate! add new type
					}else if(this.data==14){
					   dirtsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==15){
					   claysprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==16){
					   wtfsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.data==17){
					   pedastalsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					 }else{
				       canvas.fillStyle = bColors[this.data]; 
					   canvas.fillRect((this.x-cam.x)*this.width, (this.y-cam.y)*this.height, this.width, this.height);
					}
				}
				};
			
            return tile;
		};
		
		var Smedly = {
          color: "#00A",
          x: 6,
          y: 53,
		  dir: 0,
		  type: 0,
		  hp: 100,
          width: 32,
		  active: false,
          height: 32,
		  angle: 0,
		  sprite: Sprite("smedly"),
		  draw: function(cam) {
		    //canvas.save();
			//canvas.scale(2,1);
			//canvas.rotate(Math.PI* this.angle);
            this.sprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
			//canvas.restore();
			//canvas.scale(-2,-2);
		  },
        
          update: function() {
			this.angle++;
			if (this.angle>359) {this.angle=0;}
       
          },
        
          explode: function() {
            Sound.play("explosion");
        
            this.active = false;
            // Extra Credit: Add an explosion graphic
          }
        
		  };
		
        var player = {
          color: "#00A",
          x: 30,
          y: 20,
		  dir: 0,
		  type: 0,
          width: 32,
          height: 32,
		  ani: 0,
		  kills: 0,
		  swordlen: 12,
		  swordwidth: 4,
		  swordspeed: 1,
		  swordtrack: 0,
		  swordcount: 0,
		  swordactive: false,
		  swordgoing: true,
		  init: function () {
			this.sprites=new Array(4); //4 directions
			this.sprites[0] = new Array(2);  //2 frames
			this.sprites[1] = new Array(2);
			this.sprites[2] = new Array(2);
			this.sprites[3] = new Array(2);
			this.sprites[0][0]= Sprite("bearback1");
			this.sprites[0][1]= Sprite("bearback2");
			
			this.sprites[1][0]= Sprite("bearr1");
			this.sprites[1][1]= Sprite("bearr2");
			
			this.sprites[2][0]= Sprite("bear1");
			this.sprites[2][1]= Sprite("bear2");
			
			this.sprites[3][0]= Sprite("bearl1");
			this.sprites[3][1]= Sprite("bearl2");
		  },
		  hitsword: function (px,py,pw,ph){
		        if(!this.swordactive) {return false;} //todo: change this to check rectangle not just end point.
				if(this.dir==0){
				    tempx=(this.x)*16+16;
					tempy=(this.y)*16-this.swordtrack*2;
					if((tempx > px*16) && (tempx < px*16+pw)){
						if((tempy >py*16) && (tempy< py*16+ph)){
						  return true;
						}
					}

				}else if(this.dir==1){
				    tempx=(this.x)*16+32+this.swordtrack*2;;
					tempy=(this.y)*16+16
					if((tempx > px*16) && (tempx < px*16+pw)){
						if((tempy >py*16) && (tempy< py*16+ph)){
						  return true;
						}
					}
				}else if(this.dir==2){
				    tempx=(this.x)*16+16;
					tempy=(this.y)*16+32+this.swordtrack*2;
					if((tempx > px*16) && (tempx < px*16+pw)){
						if((tempy >py*16) && (tempy< py*16+ph)){
						  return true;
						}
					}
				}else if(this.dir==3){
			    tempx=(this.x)*16-this.swordtrack*2;;
					tempy=(this.y)*16+16
					if((tempx > px*16) && (tempx < px*16+pw)){
						if((tempy >py*16) && (tempy< py*16+ph)){
						  return true;
						}
					}
				}
				return false;
			},
          drawsword: function(cam){
		  		
				canvas.fillStyle = "#7CFC00";
				if(this.dir==0){
					
					canvas.fillRect((this.x-cam.x)*16+16, (this.y-cam.y)*16, this.swordwidth, -this.swordtrack*2);
					//canvas.moveTo((this.x-cam.x)*16+16, (this.y-cam.y)*16);
					//canvas.lineTo(((this.x-cam.x))*16+16, (this.y-cam.y)*16-this.swordtrack*2);  
				}else if(this.dir==1){
					canvas.fillRect((this.x-cam.x)*16+32, (this.y-cam.y)*16+16, this.swordtrack*2,this.swordwidth);
					//canvas.moveTo((this.x-cam.x)*16+32, (this.y-cam.y)*16+16);
					//canvas.lineTo(((this.x-cam.x))*16+32+this.swordtrack*2, (this.y-cam.y)*16+16);
				}else if(this.dir==2){
					canvas.fillRect((this.x-cam.x)*16+16, (this.y-cam.y)*16+32, this.swordwidth, this.swordtrack*2);
					//canvas.moveTo((this.x-cam.x)*16+16, (this.y-cam.y)*16+32);
					//canvas.lineTo(((this.x-cam.x))*16+16, (this.y-cam.y)*16+32+this.swordtrack*2);
				}else if(this.dir==3){
					canvas.fillRect((this.x-cam.x)*16, (this.y-cam.y)*16+16, -this.swordtrack*2,this.swordwidth);
					//canvas.moveTo((this.x-cam.x)*16, (this.y-cam.y)*16+16);
					//canvas.lineTo(((this.x-cam.x))*16-this.swordtrack*2, (this.y-cam.y)*16+16);
				}
				
				//alert("nuh");
			},
			
		  animate: function() {
		  if(this.ani==0){
				this.ani=1;
			}else{
				this.ani=0;
			}
		  },
		  
		  draw: function(cam) {
            canvas.fillStyle = bColors[this.type];
            canvas.fillRect((this.x-cam.x)*16, (this.y-cam.y)*16, this.width, this.height);

          },
		  
		  getKeys: function(merp) {
		      if(this.swordactive){
                 if(this.swordgoing) {
					this.swordtrack+=3;
					}

				 if(!this.swordgoing) {
					this.swordtrack-=3;
					}
					
					if (this.swordtrack>this.swordlen) { 
					    this.swordgoing=false;
						this.swordtrack=this.swordlen;
						//this.swordactive=false;
					}
					
					if (this.swordtrack<1) { 
					    this.swordgoing=true
						this.swordtrack=0;
						this.swordactive=false;
					}

			  }
		      if(defkey.check()){
				if (!this.swordactive){
					this.swordactive=true;
					
				}
			  }
		  
			  if(keydown.a) {
			    this.dir=3;
				this.animate();
			    if ((merp.canWalk([this.x-1],[this.y])) && (merp.canWalk([this.x-1],[this.y+1]))) {this.x -= 1;}
			  }
			
			  if(keydown.d) {
			    this.dir=1;
				this.animate();
				if ((merp.canWalk([this.x+2],[this.y])) && (merp.canWalk([this.x+2],[this.y+1]))) {this.x += 1;}
			  }
			  
			  if(keydown.w) {
			    this.dir=0;
				this.animate();
				if ((merp.canWalk([this.x],[this.y-1])) && (merp.canWalk([this.x+1],[this.y-1]))) {this.y -= 1;}
			  }
			
			  if(keydown.s) {
			    this.dir=2;
				this.animate(); 
				if ((merp.canWalk([this.x],[this.y+2])) && (merp.canWalk([this.x+1],[this.y+2]))) {this.y += 1;}
			  }
			  this.x = this.x.clamp(0, MAP_WIDTH-1);
			  this.y = this.y.clamp(0, MAP_HEIGHT-1);
		  }
        
        };
		
		 var edcursor = {
          color: "#00A",
          x: 1,
          y: 1,
		  slow: false,
		  mouse: true,
		  size: 1, //TODO: add for loops to draw, placement to make larger brush size, center it?
		  type: 1,
          width: 16,
          height: 16,
          draw: function(cam) {
            	    if(this.type==0){
					   grasssprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==1){
					   darkgrasssprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==2){
					   lavasprite[tileani].draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==3){
					   watersprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==4){
					   stonesprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==5){
					   obsidiansprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==6){
					   mudsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==7){
					   bricksprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==8){
					   woodsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==9){
					   crystalsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==10){
					   mossysprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16); 
					}else if(this.type==11){
					   stonebricksprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==12){
					   plankssprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==13){
					   cobblesprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16); //todo:  add new types
					}else if(this.type==14){
					   dirtsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==15){
					   claysprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==16){
					   wtfsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else if(this.type==17){
					   pedastalsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
					}else{
				       canvas.fillStyle = bColors[this.data]; 
					   canvas.fillRect((this.x-cam.x)*this.width, (this.y-cam.y)*this.height, this.width, this.height);
					}
					edsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
          },
		  getKeys: function() {
		  	  if(nkey.check()) { 
				  this.type++;
				  if (this.type > NUM_TILES) {this.type=0;}
			  }
			  
			  if(slowkey.check()) {
				this.slow=!this.slow;
			  }
			  
			  if(cmousekey.check()) {
				this.mouse=!this.mouse;
			  }
			  
			  
			  
			  if (this.slow) {
			  	if(leftkey.check()) {
					this.x -= 1;
				  }
				
				  if(rightkey.check()) {
					this.x += 1;
				  }
				  
				  if(upkey.check()) {
					this.y -= 1;
				  }
				
				  if(downkey.check()) {
					this.y += 1;
				  }
				  
			  }else{
			
				  if(keydown.a) {
					this.x -= 1;
				  }
				
				  if(keydown.d) {
					this.x += 1;
				  }
				  
				  if(keydown.w) {
					this.y -= 1;
				  }
				
				  if(keydown.s) {
					this.y += 1;
				  }
			  }
			  this.x = this.x.clamp(0, MAP_WIDTH-1);
			  this.y = this.y.clamp(0, MAP_HEIGHT-1);
		  }
        };
        
		function Map(I) {
            I = I || {};
		    var i = 0;
			var j = 0;
		    I.active = true;
            I.color = "#00A";
            I.tiles = new Array(MAP_WIDTH);
			for( i=0; i<MAP_WIDTH; i++ ) { I.tiles[i] = new Array(MAP_HEIGHT); }
		    for (i=0;i<MAP_WIDTH; i++){
		        for (j=0;j<MAP_HEIGHT; j++){
					I.tiles[i][j]= makeNewTile();
					I.tiles[i][j].x=i;
					I.tiles[i][j].y=j;
				}
			}
            I.width = MAP_WIDTH;
            I.height = MAP_HEIGHT;
            I.draw = function(cam) {
				cam.check();
				for (i=cam.x;i<cam.x+cam.width; i++){
					for (j=cam.y;j<cam.y+cam.height; j++){
						I.tiles[i][j].draw(cam);
					}
				}
			};
		    I.saveTiles = function (name) {
			    //var myString = JSON.stringify(I.tiles); //!?!
				var tempstring= "";
				for (i=0;i<MAP_WIDTH; i++){
					for (j=0;j<MAP_HEIGHT; j++){
					    /*tempo=" ";
						if (I.tiles[i][j].data <10)
						{
						    tempo+=I.tiles[i][j].data;
							tempstring = tempstring +tempo;
						}else*/ {tempstring = tempstring +I.tiles[i][j].data;}
						tempstring += ","
					}
				}
				localStorage.setItem(name, tempstring);
			    //alert (tempstring);
			};
		    I.loadDefaultTiles = function () {
				tempstring="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,0,0,1,1,1,1,1,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,0,0,1,1,1,1,1,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,5,9,9,9,9,9,9,9,9,9,9,9,9,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,7,7,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,7,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,7,7,7,7,7,7,7,7,7,7,7,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,6,6,6,6,6,6,6,6,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,6,6,6,6,6,6,6,6,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,6,6,6,6,6,6,6,6,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,6,6,6,6,6,6,6,6,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,6,6,6,6,6,6,6,6,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,6,6,6,6,6,6,6,6,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,8,8,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,8,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,8,8,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,".split(",");
				for (i=0;i<MAP_WIDTH; i++){
					for (j=0;j<MAP_HEIGHT; j++){
						I.tiles[i][j].data = tempstring[j+MAP_HEIGHT*i];
					}
				}
			};
		    I.loadTiles = function (name) {
				hempstring=localStorage.getItem(name);
				tempstring=hempstring.split(",");
				for (i=0;i<MAP_WIDTH; i++){
					for (j=0;j<MAP_HEIGHT; j++){
						I.tiles[i][j].data = tempstring[j+MAP_HEIGHT*i];
					}
				}
			};
		    I.setTile = function (x,y,data) {
		       I.tiles[x][y].data = data;
			};
			
		    I.canWalk = function (x,y) { //overhead + side mode
		      if ((I.tiles[x][y].data ==2)  || (I.tiles[x][y].data ==3 ) || (I.tiles[x][y].data ==5) || (I.tiles[x][y].data ==7)|| (I.tiles[x][y].data ==8)) {
				return false;
			  }else {return true;}
		    };
			
			
			I.canStand = function (x,y) { //sidemode only
		      if ((I.tiles[x][y].data ==7)  || (I.tiles[x][y].data ==7 ) || (I.tiles[x][y].data ==5) || (I.tiles[x][y].data ==7)|| (I.tiles[x][y].data ==8)) {
				return true;
			  }else {return false;}
		    };
			
			
			I.drawRadar= function (cam,x,y,px,py) {
				cam.check();
				canvas.save();
				canvas.globalAlpha = 0.75;
				for (i=0;i<MAP_WIDTH; i++){
					for (j=0;j<MAP_HEIGHT; j++){
						  canvas.fillStyle = bColors[I.tiles[i][j].data];
						  canvas.fillRect(x+i*2, y+j*2, 2, 2);
          
					}
				}
				canvas.fillStyle = "#FFD700";
				canvas.fillRect(x+px*2, y+py*2, 4, 4);
				canvas.restore();
			};
		    return I;
        }
		
		
        function Bullet(I) {
          I.active = true;
        
          if(I.dir==0){
			I.xVelocity = 0;
			I.yVelocity = -I.speed;
		  }else if(I.dir==1){
			I.xVelocity = +I.speed;
			I.yVelocity = 0;
		  }else if(I.dir==2){
			I.xVelocity = 0;
			I.yVelocity = +I.speed;
		  }else if(I.dir==3){
			I.xVelocity = -I.speed;
			I.yVelocity = 0;
		  }
          I.width = 3;
          I.height = 3;
		  I.dir = 1;
          I.color = "#000";
        
          I.inBounds = function() {
            return I.x >= 0 && I.x <= MAP_WIDTH &&
              I.y >= 0 && I.y <= MAP_HEIGHT;
          };
        
          I.draw = function(cam) {
            canvas.fillStyle = this.color;
            canvas.fillRect((this.x-cam.x)*16, (this.y-cam.y)*16, this.width, this.height);
          };
          
          I.update = function(merp) {
            I.x += I.xVelocity;
            I.y += I.yVelocity;
        
            I.active = I.active && I.inBounds();
			if((I.x>MAP_WIDTH-1) || (I.y>MAP_HEIGHT-1) || (I.x<0) || (I.y<0)) {
				I.active=false;
			}else if(!merp.canWalk([I.x],[I.y])) {I.active=false;} //todo:play a ding sound, change to merp.canflyover?
			
          };
        
          I.explode = function() {
            this.active = false;
            // TODO: Add an explosion graphic
          };
		  
		  I.checkHit= function(targ) {
			tempx=I.x*16;
			tempy=I.y*16;
			//alert("");
		  if((tempx > targ.x*16) && (tempx <targ.x*16+targ.width) && (tempy > targ.y*16) && (tempy <targ.y*16+targ.height)) {
		    I.active=false;
			return true;
			
		  }
		  return false;
		  };
		  
      
          return I;
        }
        
        enemies = [];
        maps = [];
		maps.push(Map());
        function Enemy(I) {
          I = I || {};
        
          I.active = true;
          I.age = Math.floor(Math.random() * 128);
          
          I.color = "#A2B";
        
          I.x = Math.floor(Math.random() * MAP_WIDTH);
          I.y = 5;
          I.xVelocity = 0
          I.yVelocity = 1;
        
          I.width = 32;
          I.height = 32;
        
          I.inBounds = function() {
            return I.x >= 0 && I.x <= MAP_WIDTH &&
              I.y >= 0 && I.y <= MAP_HEIGHT;
          };
        
          I.sprite = Sprite("enemy1");
        
          I.draw = function(cam) {
            this.sprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
          };
        
          I.update = function() {
            I.x += I.xVelocity/4;
            I.y += I.yVelocity/4;
        
            I.xVelocity = 3 * Math.sin(I.age * Math.PI / 64);
        
            I.age++;
        
            I.active = I.active && I.inBounds();
          };
        
          I.explode = function() {
            Sound.play("explosion");
        
            this.active = false;
            // Extra Credit: Add an explosion graphic
          };
        
          return I;
        };
        

        setInterval(function() {
          update();
          draw();
        }, 1000/FPS);
		maps[0].loadDefaultTiles();
		for(ijk=0;ijk<32;ijk++)
		{
			
			tempx=Math.floor(Math.random() *MAP_WIDTH);
			tempy=Math.floor(Math.random() *MAP_HEIGHT);
			if(maps[0].tiles[tempx][tempy].data==0) {
				stuff.push(new thing(tempx,tempy));
			}
		}
		stuff.push(new thing(5,5));
		
	document.getElementById("myAudio").addEventListener('ended', function() {
    this.currentTime = 0;
    this.play();
	}, false);
		
		document.getElementById("myAudio").play();
		
		player.init();
	//------------MAIN-----------------------------------------
        function update() {
		
		if (player.hitsword(5,5,20,20)) {alert ("hit it!");}
		
		    anicount++;
			if (anicount>anirate) {
				tileani++;
				anicount=0;
			}
			if (tileani>4) {tileani=0} //tile animations
			
		    if(modekey.check()) {
				if (Mode==0) {
					Mode=1;
					camera.center(edcursor);
				}else if (Mode==1) {
				    Mode=0;
					camera.center(player); 
				}else if (Mode==2) {
				    Mode=0;
				}
					
			 }
			  if(shiftkey.check()) { 
			  if (Mode==0) {  camera.center(player); }
			  if (Mode==1) {  camera.center(edcursor); }
			  }
			  //if(hkey.check()) {alert("NO HELP FOR YOU");}
		    if (true){ //camera mode
			 			
			  if(keydown.left) {
				camera.x -= 1;
				if (camera.x<0) {camera.x=0;}
			  }
			
			  if(keydown.right) {
				camera.x += 1;
				if (camera.x>(MAP_WIDTH-camera.width)) {camera.x=MAP_WIDTH-camera.width;}
			  }
			  
			  if(keydown.up) {
				//canvas.scale(2,2);
				camera.y -= 1;
				if (camera.y<0) {camera.y=0;}
			  }
			
			  if(keydown.down) {
				camera.y += 1;
				//canvas.scale(-2,-2);
				if (camera.y>(MAP_HEIGHT-camera.height)) {camera.y=MAP_HEIGHT-camera.height;}
			  }
			 

		  } if(Mode==1){ //edit mode
		      if (defkey.check()) {maps[0].loadDefaultTiles();}
			  if(keydown.space) {
				maps[0].setTile(edcursor.x,edcursor.y,edcursor.type);
			  }
			  if(savekey.check()) {
				maps[0].saveTiles("edsmap");
			  }
			  			  
			  if(loadkey.check()) {
				maps[0].loadTiles("edsmap");
			  }
			  
			  if(helpkey.check()){
			    alert("W,A,S,D = move cursor, B = toggle speed, Space = Place block, V = Mouse mode toggle, N = switch block, Shift= Center Camera on cursor, M= switch to player mode, O = save map, L= loadmap");
			 }
			 
			 if (edcursor.mouse) {
				edcursor.x=Math.round(canX/16)+camera.x;
				edcursor.y=Math.round(canY/16)+camera.y;
				if(Mouse.mouseIsDown){
				  maps[0].setTile(edcursor.x,edcursor.y,edcursor.type)
				}
				if(Mouse.wasWheeled) {
					Mouse.wasWheeled=false;
					if(Mouse.mDelta>0) {
						edcursor.type++;
						if (edcursor.type > NUM_TILES) {edcursor.type=0;}
					}else{
						edcursor.type--;
						if (edcursor.type <0) {edcursor.type=NUM_TILES;}
				    } 
				}
			}
			  
			  edcursor.getKeys();
		  }else if(Mode==0) {

			player.getKeys(maps[0]);
		     if(keydown.space) { 
				  player.shoot();
			  }
			  camera.center(player);
			  if(helpkey.check()){
			    alert("Arrow keys = move player, Space = shoot, M= switch to edit mode");
			 }
		  }
        ////process things
			  playerBullets.forEach(function(bullet) {  
				bullet.update(maps[0]);
			  });
		  stuff.forEach(function(thing) {
            thing.update(player);
          });
		  if(!stuff[0]) {gotall=true;}
		  if((gotall) && (player.kills>4))
		  { 
			Smedly.active=true;
			gotall=false;
		  }
		  handleCollisions();
          playerBullets = playerBullets.filter(function(bullet) {
            return bullet.active;
          });
          
          enemies.forEach(function(enemy) {
            enemy.update();
          });
        
          enemies = enemies.filter(function(enemy) {
            return enemy.active;
          });
		  
		  stuff = stuff.filter(function(thing) {
            return thing.active;
          });
        
          
        
          if((Math.random() < 0.1) && (enemies.length<5)) {
            enemies.push(Enemy());
          }
        }
        
        player.shoot = function() {
          if (playerBullets.length>9) {return;}
		  //Sound.play("shoot");
        
          var bulletPosition = this.midpoint();
		  bulletPosition.x=this.x;
		  bulletPosition.y=this.y;
        
          playerBullets.push(Bullet({ 
            speed: 1,
			dir: this.dir,
            x: bulletPosition.x,
            y: bulletPosition.y
          }));
        };
        
        player.midpoint = function() {
          return {
            x: this.x + this.width/2,
            y: this.y + this.height/2
          };
        };
        
        function draw() {
          canvas.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

		  
		 maps.forEach(function(imap) {
            imap.draw(camera);
			//imap.drawRadar(camera, 580, 466,player.x,player.y);
         });
		 
		 
		 

		 if(Mode==1) { edcursor.draw(camera);}
          
          playerBullets.forEach(function(bullet) {
            bullet.draw(camera);
          });
		  
		  stuff.forEach(function(thing) {
            thing.draw(camera);
          });
		  
		  //stuff[0].draw(camera);
        
          enemies.forEach(function(enemy) {
            enemy.draw(camera);
          });
		  
		if(Smedly.active){
			Smedly.draw(camera);
		}
		  
		 if(true) { player.draw(camera);}
				 
				 

		 if(maps[0].tiles[player.x][player.y+1].data==1) {
			darkgrasssprite.draw(canvas, (player.x-camera.x)*16, (player.y-camera.y+1)*16);
		
		 }//todo work this into person.draw, so it work for all npcs
		  if(maps[0].tiles[player.x+1][player.y+1].data==1) {
			darkgrasssprite.draw(canvas, (player.x-camera.x+1)*16, (player.y-camera.y+1)*16);
		
		 }
		 
		  maps.forEach(function(imap) {
            //imap.draw(camera);
			imap.drawRadar(camera, 645, 466,player.x,player.y);
         });
        }
        
        function collides(a, b) {
          return a.x*16 < b.x + b.width &&
            a.x*16 + a.width > b.x &&
            a.y*16 < b.y + b.height &&
            a.y*16 + a.height > b.y;
        }
		
      
        function handleCollisions() {
          playerBullets.forEach(function(bullet) {
            enemies.forEach(function(enemy) {
              if(bullet.checkHit(enemy)) {
                enemy.explode();
                bullet.active = false;
				player.kills++;
              }
            });
          });
        
          enemies.forEach(function(enemy) {
            if(collides(enemy, player)) {
              enemy.explode();
              player.explode();
            }
			if(player.hitsword(enemy.x,enemy.y,32,32)) {
			enemy.explode();
			player.kills++;
			}
          });
        }
        
		if(Smedly.active){
			Smedly.update();
			}
		
        player.explode = function() {
          this.active = false;
          // Extra Credit: Add an explosion graphic and then end the game
        };
        
        //player.sprite = Sprite("player");
		
        
        player.draw = function(cam) {
		  //canvas.globalCompositeOperation = 'source-in';
          this.sprites[this.dir][this.ani].draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
		  this.drawsword(cam);
		  //canvas.globalCompositeOperation = 'source-over';
        };
		/*thing.draw= function(cam) {
				shroomsprite.draw(canvas, (this.x-cam.x)*16, (this.y-cam.y)*16);
				//alert ("WHY");
			};*/
      //]]>
    </script>

  </body>
</html>
